<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Confidence Interval Calculator</title>

  <!-- Bootstrap (local) -->
  <link href="./css/bootstrap.min.css" rel="stylesheet"/>
  <script src="./js/bootstrap.bundle.min.js"></script>

  <!-- Font Awesome (local) -->
  <link rel="stylesheet" href="./css/font-awesome.min.css"/>

  <style>
    body {
      background-color: #0f172a;
      color: #f8fafc;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter",
        Roboto, "Segoe UI", sans-serif;
      min-height: 100vh;
      padding-top: 2rem;
      padding-bottom: 2rem;
      display: flex;
      flex-direction: column;
    }
    .page-wrapper {
      flex: 1 0 auto;
    }

    .card {
      background: #1e253b;
      border: 1px solid #334155;
      border-radius: 1rem;
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6);
      color: #f8fafc;
    }

    .card-header {
      background: radial-gradient(
        circle at 0% 0%,
        rgba(56, 189, 248, 0.08) 0%,
        rgba(30, 37, 59, 0) 60%
      );
      border-bottom: 1px solid #334155;
      border-radius: 1rem 1rem 0 0 !important;
      color: #f8fafc;
    }

    .text-secondary {
      color: #94a3b8 !important;
      font-size: 0.9rem;
    }

    footer {
      border-top: 1px solid #334155;
      margin-top: 3rem;
      padding-top: 1rem;
      padding-bottom: 1rem;
      color: #94a3b8;
      text-align: center;
    }

    .hm-foot-icon a {
      color: #38bdf8;
      font-size: 1.2rem;
      display: inline-flex;
      width: 2rem;
      height: 2rem;
      align-items: center;
      justify-content: center;
      transition: 0.3s;
      text-decoration: none;
    }

    .hm-foot-icon a:hover {
      color: #0ea5e9;
      text-shadow: 0 0 8px rgba(56, 189, 248, 0.8);
    }

    footer a {
      color: #38bdf8;
      text-decoration: none;
      font-weight: 500;
    }

    footer a:hover {
      color: #0ea5e9;
      text-shadow: 0 0 8px rgba(56, 189, 248, 0.8);
    }

    .badge-soft {
      background-color: rgba(56, 189, 248, 0.1);
      color: #38bdf8;
      border-radius: 999px;
      padding: 0.15rem 0.6rem;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .result-highlight {
      color: #38bdf8;
      font-weight: 600;
    }

    .step-list {
      list-style: none;
      padding-left: 0;
      margin-bottom: 0;
    }

    .step-list li {
      margin-bottom: 0.75rem;
      display: flex;
      gap: 0.6rem;
    }

    .step-number {
      flex-shrink: 0;
      width: 1.5rem;
      height: 1.5rem;
      border-radius: 999px;
      background-color: #0f172a;
      border: 1px solid #38bdf8;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 600;
      color: #38bdf8;
      margin-top: 0.05rem;
    }

    .step-text {
      font-size: 0.9rem;
      color: #e2e8f0;
    }

    .step-text strong {
      color: #f9fafb;
    }

    .small-label {
      font-size: 0.8rem;
      color: #94a3b8;
    }

    .form-control,
    .form-select {
      background-color: #020617;
      border-color: #334155;
      color: #e2e8f0;
    }

    .form-control:focus,
    .form-select:focus {
      background-color: #020617;
      color: #e2e8f0;
      border-color: #38bdf8;
      box-shadow: 0 0 0 0.2rem rgba(56, 189, 248, 0.25);
    }

    .form-text {
      font-size: 0.75rem;
    }

    .alert-soft {
      background-color: rgba(239, 68, 68, 0.08);
      border: 1px solid rgba(239, 68, 68, 0.4);
      color: #fecaca;
      border-radius: 0.75rem;
      padding: 0.6rem 0.75rem;
      font-size: 0.8rem;
      margin-bottom: 0.75rem;
    }

    .summary-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem 1.5rem;
      font-size: 0.85rem;
      margin-bottom: 0.75rem;
    }

    .summary-label {
      color: #cbd5f5;
    }

    .summary-value {
      color: #38bdf8;
      font-weight: 600;
    }

    .result-box {
      background-color: #020617;
      border-radius: 0.75rem;
      padding: 0.75rem 0.9rem;
      border: 1px solid #334155;
      font-size: 0.9rem;
      margin-bottom: 0.75rem;
    }
  </style>
</head>
<body>
<div class="container page-wrapper">
  <div class="text-center mb-4">
    <h1 class="h3 mb-1">Confidence Interval Calculator</h1>
    <div class="text-secondary">
      Build CIs for <span class="result-highlight">one mean</span> or
      <span class="result-highlight">difference between two means</span> using Z-based formulas.
    </div>
  </div>

  <div class="row g-4">
    <!-- LEFT: Inputs -->
    <div class="col-lg-4">
      <div class="card h-100">
        <div class="card-header d-flex justify-content-between align-items-center">
          <div>
            <div class="fw-semibold">Inputs</div>
            <div class="small text-secondary">
              Choose number of samples and fill in mean, size, and SD.
            </div>
          </div>
          <span class="badge-soft">
            Z-CI
          </span>
        </div>
        <div class="card-body">
          <!-- Number of samples -->
          <div class="mb-3">
            <label class="form-label">
              Number of samples
              <span class="small-label">(1 = CI for μ, 2 = CI for μ₁ − μ₂)</span>
            </label>
            <select id="numSamples" class="form-select">
              <option value="1" selected>1 sample (mean)</option>
              <option value="2">2 samples (difference of means)</option>
            </select>
          </div>

          <!-- Confidence level -->
          <div class="mb-3">
            <label class="form-label">
              Confidence level (%)
            </label>
            <input id="clInput" type="number" step="0.1" value="95" min="50" max="99.9" class="form-control" />
            <div class="form-text text-secondary">
              Example: 95 → α = 1 − 0.95 = 0.05.
            </div>
          </div>

          <!-- Sample 1 -->
          <div class="mb-3 border-top pt-3">
            <div class="d-flex justify-content-between align-items-center mb-1">
              <span class="fw-semibold">Sample 1</span>
              <span class="small-label text-secondary">Group 1 (μ₁)</span>
            </div>
            <div class="mb-2">
              <label class="form-label small-label">Mean of sample 1 (X̄₁)</label>
              <input id="mean1Input" type="number" step="0.01" class="form-control" />
            </div>
            <div class="mb-2">
              <label class="form-label small-label">Sample size (n₁)</label>
              <input id="n1Input" type="number" min="1" step="1" class="form-control" />
            </div>
            <div class="mb-2">
              <label class="form-label small-label">Standard deviation (s₁ or σ₁)</label>
              <input id="sd1Input" type="number" step="0.01" min="0" class="form-control" />
            </div>
          </div>

          <!-- Sample 2 -->
          <div id="sample2Block" class="mb-3 border-top pt-3" style="display:none;">
            <div class="d-flex justify-content-between align-items-center mb-1">
              <span class="fw-semibold">Sample 2</span>
              <span class="small-label text-secondary">Group 2 (μ₂)</span>
            </div>
            <div class="mb-2">
              <label class="form-label small-label">Mean of sample 2 (X̄₂)</label>
              <input id="mean2Input" type="number" step="0.01" class="form-control" />
            </div>
            <div class="mb-2">
              <label class="form-label small-label">Sample size (n₂)</label>
              <input id="n2Input" type="number" min="1" step="1" class="form-control" />
            </div>
            <div class="mb-2">
              <label class="form-label small-label">Standard deviation (s₂ or σ₂)</label>
              <input id="sd2Input" type="number" step="0.01" min="0" class="form-control" />
            </div>
            <div class="form-text text-secondary">
              We will estimate a CI for μ₁ − μ₂ (Sample 1 minus Sample 2).
            </div>
          </div>

          <div class="d-flex gap-2 mt-3">
            <button id="calcBtn" class="btn btn-primary flex-grow-1">
              <i class="fa-solid fa-calculator me-1"></i> Calculate CI
            </button>
            <button id="resetBtn" class="btn btn-outline-secondary flex-grow-1">
              Reset
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT: Results -->
    <div class="col-lg-8">
      <div class="card h-100">
        <div class="card-header">
          <div class="fw-semibold">Result & Step-by-Step Explanation</div>
          <div class="small text-secondary" id="resultSubtitle">
            Fill the inputs on the left and click "Calculate CI".
          </div>
        </div>
        <div class="card-body">
          <div id="errorBox" style="display:none;" class="alert-soft"></div>

          <!-- Summary of alpha / z -->
          <div id="summaryBox" style="display:none;">
            <div class="result-box">
              <div class="summary-row">
                <div>
                  <span class="summary-label">Confidence level:</span>
                  <span class="summary-value" id="summaryCL"></span>
                </div>
                <div>
                  <span class="summary-label">α:</span>
                  <span class="summary-value" id="summaryAlpha"></span>
                </div>
                <div>
                  <span class="summary-label">α/2:</span>
                  <span class="summary-value" id="summaryAlpha2"></span>
                </div>
                <div>
                  <span class="summary-label">z<sub>α/2</sub>:</span>
                  <span class="summary-value" id="summaryZ"></span>
                </div>
              </div>
              <div id="summaryExtra" class="small text-secondary"></div>
            </div>

            <!-- Final CI -->
            <div class="result-box mb-3">
              <div class="mb-1 fw-semibold" id="ciTitle">Confidence Interval:</div>
              <div id="ciText" class="mb-1">
                –
              </div>
              <div id="ciInterpretation" class="small text-secondary"></div>
            </div>
          </div>

          <!-- Step-by-step explanation -->
          <ol id="stepsList" class="step-list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

<footer>
  <div class="hm-foot-icon mb-2">
    <a href="https://www.facebook.com/dror.mor.9" target="_blank"
      ><i class="fab fa-facebook"></i
    ></a>
    <a href="https://github.com/ColgateSmile" target="_blank"
      ><i class="fab fa-github"></i
    ></a>
    <a
      href="https://www.linkedin.com/in/dror-mor-%D7%93%D7%A8%D7%95%D7%A8-%D7%9E%D7%95%D7%A8-90865a201/"
      target="_blank"
      ><i class="fab fa-linkedin"></i
    ></a>
    <a href="https://www.instagram.com/drmor1994/" target="_blank"
      ><i class="fab fa-instagram"></i
    ></a>
  </div>
  <small>
    Created by <span style="color:#38bdf8;">Dror Mor</span> |
    <a href="https://colgatesmile.github.io/DrorMorResume/" target="_blank"
      >Website</a
    >
    |
    <a href="https://github.com/ColgateSmile" target="_blank">GitHub</a>
  </small>
</footer>

<script>
  // ---------- Helper: format numbers ----------
  function fmt(v, decimals = 3) {
    if (!isFinite(v)) return "–";
    return Number(v).toFixed(decimals);
  }

  // ---------- Inverse normal CDF (for z_{alpha/2}) ----------
  // Approximation by Peter John Acklam (standard, good enough for CL calc).
  function inverseNormalCDF(p) {
    if (p <= 0 || p >= 1) return NaN;

    const a1 = -39.69683028665376;
    const a2 = 220.9460984245205;
    const a3 = -275.9285104469687;
    const a4 = 138.3577518672690;
    const a5 = -30.66479806614716;
    const a6 = 2.506628277459239;

    const b1 = -54.47609879822406;
    const b2 = 161.5858368580409;
    const b3 = -155.6989798598866;
    const b4 = 66.80131188771972;
    const b5 = -13.28068155288572;

    const c1 = -0.007784894002430293;
    const c2 = -0.3223964580411365;
    const c3 = -2.400758277161838;
    const c4 = -2.549732539343734;
    const c5 = 4.374664141464968;
    const c6 = 2.938163982698783;

    const d1 = 0.007784695709041462;
    const d2 = 0.3224671290700398;
    const d3 = 2.445134137142996;
    const d4 = 3.754408661907416;

    const plow = 0.02425;
    const phigh = 1 - plow;
    let q, r;

    if (p < plow) {
      q = Math.sqrt(-2 * Math.log(p));
      return (
        (((((c1 * q + c2) * q + c3) * q + c4) * q + c5) * q + c6) /
        ((((d1 * q + d2) * q + d3) * q + d4) * q + 1)
      );
    }

    if (p > phigh) {
      q = Math.sqrt(-2 * Math.log(1 - p));
      return (
        -(((((c1 * q + c2) * q + c3) * q + c4) * q + c5) * q + c6) /
        ((((d1 * q + d2) * q + d3) * q + d4) * q + 1)
      );
    }

    q = p - 0.5;
    r = q * q;
    return (
      (((((a1 * r + a2) * r + a3) * r + a4) * r + a5) * r + a6) * q /
      (((((b1 * r + b2) * r + b3) * r + b4) * r + b5) * r + 1)
    );
  }

  function getZCritical(alpha) {
    const tail = alpha / 2;
    const p = 1 - tail; // quantile for upper tail
    return inverseNormalCDF(p);
  }

  // ---------- DOM elements ----------
  const numSamplesEl = document.getElementById("numSamples");
  const clInputEl = document.getElementById("clInput");

  const mean1Input = document.getElementById("mean1Input");
  const n1Input = document.getElementById("n1Input");
  const sd1Input = document.getElementById("sd1Input");

  const sample2Block = document.getElementById("sample2Block");
  const mean2Input = document.getElementById("mean2Input");
  const n2Input = document.getElementById("n2Input");
  const sd2Input = document.getElementById("sd2Input");

  const calcBtn = document.getElementById("calcBtn");
  const resetBtn = document.getElementById("resetBtn");

  const errorBox = document.getElementById("errorBox");
  const summaryBox = document.getElementById("summaryBox");
  const resultSubtitle = document.getElementById("resultSubtitle");

  const summaryCL = document.getElementById("summaryCL");
  const summaryAlpha = document.getElementById("summaryAlpha");
  const summaryAlpha2 = document.getElementById("summaryAlpha2");
  const summaryZ = document.getElementById("summaryZ");
  const summaryExtra = document.getElementById("summaryExtra");

  const ciTitle = document.getElementById("ciTitle");
  const ciText = document.getElementById("ciText");
  const ciInterpretation = document.getElementById("ciInterpretation");

  const stepsList = document.getElementById("stepsList");

  // ---------- UI behavior ----------
  function updateSampleVisibility() {
    const k = parseInt(numSamplesEl.value, 10);
    if (k === 2) {
      sample2Block.style.display = "block";
    } else {
      sample2Block.style.display = "none";
    }
  }

  numSamplesEl.addEventListener("change", updateSampleVisibility);

  // ---------- Main calculation ----------
  function calculateCI() {
    errorBox.style.display = "none";
    summaryBox.style.display = "none";
    stepsList.innerHTML = "";
    ciText.textContent = "–";
    ciInterpretation.textContent = "";
    summaryExtra.textContent = "";

    const k = parseInt(numSamplesEl.value, 10);
    const clPercent = parseFloat(clInputEl.value);

    if (!isFinite(clPercent) || clPercent <= 0 || clPercent >= 100) {
      showError("Please enter a valid confidence level between 0 and 100.");
      return;
    }

    const CL = clPercent / 100;
    const alpha = 1 - CL;
    const alpha2 = alpha / 2;
    const zCrit = getZCritical(alpha);

    if (!isFinite(zCrit)) {
      showError("Unable to compute z-value. Please check the confidence level.");
      return;
    }

    // Read sample 1
    const mean1 = parseFloat(mean1Input.value);
    const n1 = parseFloat(n1Input.value);
    const sd1 = parseFloat(sd1Input.value);

    if (!isFinite(mean1) || !isFinite(n1) || !isFinite(sd1) ||
        n1 <= 0 || sd1 < 0) {
      showError("Please fill valid mean, size, and SD for sample 1.");
      return;
    }

    if (k === 1) {
      // ----- One-sample CI for μ -----
      const se1 = sd1 / Math.sqrt(n1);
      const ME = zCrit * se1;
      const lower = mean1 - ME;
      const upper = mean1 + ME;

      summaryCL.textContent = fmt(CL, 3) + " ( " + fmt(clPercent, 1) + "% )";
      summaryAlpha.textContent = fmt(alpha, 3);
      summaryAlpha2.textContent = fmt(alpha2, 3);
      summaryZ.textContent = fmt(zCrit, 3);
      summaryExtra.textContent =
        "Using one-sample Z-CI: μ ∈ X̄ ± z_{α/2} · (s / √n).";

      summaryBox.style.display = "block";

      ciTitle.textContent = "Confidence Interval for μ (one sample):";
      ciText.innerHTML =
        "CI = X̄ ± z<sub>α/2</sub> · (s / √n) = " +
        fmt(mean1, 3) +
        " ± " +
        fmt(ME, 3) +
        " ⇒ (" +
        "<span class='result-highlight'>" +
        fmt(lower, 2) +
        "</span>, " +
        "<span class='result-highlight'>" +
        fmt(upper, 2) +
        "</span>)";

      ciInterpretation.textContent =
        "We are " +
        fmt(clPercent, 1) +
        "% confident that the true population mean lies between " +
        fmt(lower, 2) +
        " and " +
        fmt(upper, 2) +
        " (same units as the sample).";

      // Step-by-step explanation
      const steps = [];

      steps.push({
        title: "Write down the sample summary.",
        text:
          "Sample mean X̄ = " +
          fmt(mean1, 3) +
          ", sample size n = " +
          fmt(n1, 0) +
          ", standard deviation s = " +
          fmt(sd1, 3) +
          "."
      });

      steps.push({
        title: "Convert confidence level to α and find z_{α/2}.",
        text:
          "Confidence level = " +
          fmt(clPercent, 1) +
          "% ⇒ CL = " +
          fmt(CL, 3) +
          ". Then α = 1 − CL = " +
          fmt(alpha, 3) +
          ", α/2 = " +
          fmt(alpha2, 3) +
          ". From the standard normal distribution, z_{α/2} ≈ " +
          fmt(zCrit, 3) +
          "."
      });

      steps.push({
        title: "Compute the standard error of the mean.",
        text:
          "SE = s / √n = " +
          fmt(sd1, 3) +
          " / √" +
          fmt(n1, 0) +
          " ≈ " +
          fmt(se1, 3) +
          ". This is the typical sampling error of X̄."
      });

      steps.push({
        title: "Compute the margin of error.",
        text:
          "ME = z_{α/2} · SE = " +
          fmt(zCrit, 3) +
          " × " +
          fmt(se1, 3) +
          " ≈ " +
          fmt(ME, 3) +
          "."
      });

      steps.push({
        title: "Build the confidence interval.",
        text:
          "CI = X̄ ± ME = " +
          fmt(mean1, 3) +
          " ± " +
          fmt(ME, 3) +
          " ⇒ (" +
          fmt(lower, 3) +
          ", " +
          fmt(upper, 3) +
          ")."
      });

      steps.push({
        title: "Interpret the result in context.",
        text:
          "We say: “We are " +
          fmt(clPercent, 1) +
          "% confident that the true mean is between " +
          fmt(lower, 2) +
          " and " +
          fmt(upper, 2) +
          " in the population from which the sample was taken.”"
      });

      renderSteps(steps);
      resultSubtitle.textContent =
        "One-sample Z-confidence interval for a population mean μ.";

    } else if (k === 2) {
      // ----- Two-sample CI for μ1 − μ2 -----
      const mean2 = parseFloat(mean2Input.value);
      const n2 = parseFloat(n2Input.value);
      const sd2 = parseFloat(sd2Input.value);

      if (!isFinite(mean2) || !isFinite(n2) || !isFinite(sd2) ||
          n2 <= 0 || sd2 < 0) {
        showError("Please fill valid mean, size, and SD for sample 2.");
        return;
      }

      const diff = mean1 - mean2; // μ1 − μ2
      const seDiff = Math.sqrt(
        (sd1 * sd1) / n1 + (sd2 * sd2) / n2
      );
      const ME = zCrit * seDiff;
      const lower = diff - ME;
      const upper = diff + ME;

      summaryCL.textContent = fmt(CL, 3) + " ( " + fmt(clPercent, 1) + "% )";
      summaryAlpha.textContent = fmt(alpha, 3);
      summaryAlpha2.textContent = fmt(alpha2, 3);
      summaryZ.textContent = fmt(zCrit, 3);
      summaryExtra.textContent =
        "Using two-sample Z-CI for the difference μ₁ − μ₂ with independent samples.";

      summaryBox.style.display = "block";

      ciTitle.textContent = "Confidence Interval for μ₁ − μ₂ (Sample 1 minus Sample 2):";
      ciText.innerHTML =
        "CI = (X̄₁ − X̄₂) ± z<sub>α/2</sub> · √( s₁²/n₁ + s₂²/n₂ ) = " +
        fmt(diff, 3) +
        " ± " +
        fmt(ME, 3) +
        " ⇒ (" +
        "<span class='result-highlight'>" +
        fmt(lower, 2) +
        "</span>, " +
        "<span class='result-highlight'>" +
        fmt(upper, 2) +
        "</span>)";

      let interpDirection = "";
      if (lower > 0) {
        interpDirection =
          "Since the entire CI is above 0, sample 1 has a higher mean than sample 2 (statistically, μ₁ > μ₂ at this confidence level).";
      } else if (upper < 0) {
        interpDirection =
          "Since the entire CI is below 0, sample 1 has a lower mean than sample 2 (statistically, μ₁ < μ₂ at this confidence level).";
      } else {
        interpDirection =
          "Because the CI includes 0, we cannot rule out that the true difference might be 0 (no clear difference between μ₁ and μ₂).";
      }

      ciInterpretation.textContent =
        "We are " +
        fmt(clPercent, 1) +
        "% confident that the true difference μ₁ − μ₂ lies between " +
        fmt(lower, 2) +
        " and " +
        fmt(upper, 2) +
        ". " +
        interpDirection;

      // Step-by-step explanation
      const steps = [];

      steps.push({
        title: "Define the parameter and write the sample summaries.",
        text:
          "We estimate μ₁ − μ₂, where group 1 has X̄₁ = " +
          fmt(mean1, 3) +
          ", n₁ = " +
          fmt(n1, 0) +
          ", s₁ = " +
          fmt(sd1, 3) +
          ", and group 2 has X̄₂ = " +
          fmt(mean2, 3) +
          ", n₂ = " +
          fmt(n2, 0) +
          ", s₂ = " +
          fmt(sd2, 3) +
          "."
      });

      steps.push({
        title: "Convert confidence level to α and find z_{α/2}.",
        text:
          "Confidence level = " +
          fmt(clPercent, 1) +
          "% ⇒ CL = " +
          fmt(CL, 3) +
          ". Then α = 1 − CL = " +
          fmt(alpha, 3) +
          ", α/2 = " +
          fmt(alpha2, 3) +
          ". From the standard normal distribution, z_{α/2} ≈ " +
          fmt(zCrit, 3) +
          "."
      });

      steps.push({
        title: "Compute the point estimate of the difference.",
        text:
          "The sample difference is d̂ = X̄₁ − X̄₂ = " +
          fmt(mean1, 3) +
          " − " +
          fmt(mean2, 3) +
          " = " +
          fmt(diff, 3) +
          "."
      });

      steps.push({
        title: "Compute the standard error of the difference.",
        text:
          "SE_diff = √( s₁²/n₁ + s₂²/n₂ ) = √( " +
          fmt(sd1 * sd1, 3) +
          "/" +
          fmt(n1, 0) +
          " + " +
          fmt(sd2 * sd2, 3) +
          "/" +
          fmt(n2, 0) +
          " ) ≈ " +
          fmt(seDiff, 3) +
          "."
      });

      steps.push({
        title: "Compute the margin of error.",
        text:
          "ME = z_{α/2} · SE_diff = " +
          fmt(zCrit, 3) +
          " × " +
          fmt(seDiff, 3) +
          " ≈ " +
          fmt(ME, 3) +
          "."
      });

      steps.push({
        title: "Build the confidence interval for μ₁ − μ₂.",
        text:
          "CI = d̂ ± ME = " +
          fmt(diff, 3) +
          " ± " +
          fmt(ME, 3) +
          " ⇒ (" +
          fmt(lower, 3) +
          ", " +
          fmt(upper, 3) +
          ")."
      });

      steps.push({
        title: "Interpret the result in context.",
        text:
          "We say: “We are " +
          fmt(clPercent, 1) +
          "% confident that the true difference in means μ₁ − μ₂ is between " +
          fmt(lower, 2) +
          " and " +
          fmt(upper, 2) +
          ".” " +
          interpDirection
      });

      renderSteps(steps);
      resultSubtitle.textContent =
        "Two-sample Z-confidence interval for the difference between two independent means μ₁ − μ₂.";
    } else {
      showError("This calculator currently supports 1 or 2 samples.");
      return;
    }
  }

  function showError(msg) {
    errorBox.textContent = msg;
    errorBox.style.display = "block";
  }

  function renderSteps(steps) {
    stepsList.innerHTML = "";
    steps.forEach((s, idx) => {
      const li = document.createElement("li");

      const numSpan = document.createElement("span");
      numSpan.className = "step-number";
      numSpan.textContent = (idx + 1).toString();

      const textDiv = document.createElement("div");
      textDiv.className = "step-text";
      textDiv.innerHTML =
        "<strong>" + s.title + "</strong><br />" + s.text;

      li.appendChild(numSpan);
      li.appendChild(textDiv);
      stepsList.appendChild(li);
    });
  }

  // ---------- Reset ----------
  function resetAll() {
    numSamplesEl.value = "1";
    updateSampleVisibility();

    clInputEl.value = 95;

    mean1Input.value = "";
    n1Input.value = "";
    sd1Input.value = "";

    mean2Input.value = "";
    n2Input.value = "";
    sd2Input.value = "";

    errorBox.style.display = "none";
    summaryBox.style.display = "none";
    stepsList.innerHTML = "";
    ciText.textContent = "–";
    ciInterpretation.textContent = "";
    summaryExtra.textContent = "";
    resultSubtitle.textContent =
      'Fill the inputs on the left and click "Calculate CI".';
  }

  // ---------- Event listeners ----------
  calcBtn.addEventListener("click", calculateCI);
  resetBtn.addEventListener("click", resetAll);

  // Initial
  updateSampleVisibility();
</script>
</body>
</html>
